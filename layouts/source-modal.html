<div class="modal-header">
    <h3>{{'evidence.heading'|translate}} <small>{{ mc.modalFields.name }}</small></h3>
</div>
<div class="modal-body">
    <div class="col-md-12">
        <h4>{{'evidence.certainty.heading'|translate}}</h4>
        <div class="row">
            <div class="col-md-offset-2 col-md-8">
                <div class="progress" ng-click="mc.modalFields.setPossibility($event)">
                    <div class="progress-bar" ng-class="{ 'progress-bar-danger': mc.modalFields.value <= 25, 'progress-bar-warning': mc.modalFields.value <= 50, 'progress-bar-info': mc.modalFields.value <= 75, 'progress-bar-success': mc.modalFields.value > 75 }" role="progressbar" aria-valuenow="{{mc.modalFields.value}}" aria-valuemin="0" aria-valuemax="100" style="width: {{ mc.modalFields.value }}%">
                        <span class="sr-only">{{ mc.modalFields.value }}% complete</span>
                        {{ mc.modalFields.value }}%
                    </div>
                </div>
                <form>
                    <div class="form-group">
                        <textarea class="form-control" ng-model="mc.modalFields.description" placeholder="{{'evidence.certainty.comment'|translate}}"></textarea>
                    </div>
                </form>
            </div>
        </div>
        <button type="button" class="btn btn-success" ng-click="mc.savePossibility()">
            <i class="material-icons">save</i> {{ 'evidence.certainty.save' | translate }}
        </button>
        <button type="button" class="btn btn-success" ng-click="mc.savePossibilityAndClose()">
            <i class="material-icons">save</i> {{ 'evidence.certainty.save+close' | translate }}
        </button>
    </div>
    <div class="col-md-12">
        <hr />
    </div>
    <div class="col-md-12">
        <h4>{{'evidence.sources.heading'|translate}}</h4>
        <table class="table table-striped table-bordered table-hover">
            <tr ng-repeat="entry in mc.modalFields.addedSources" ng-mouseenter="hovered=true;" ng-mouseleave="hovered=false;">
                <td class="td-50 word-break">
                    {{ entry.literature.title }}<span ng-if="entry.literature.year"> - <i>{{ entry.literature.year}}</i></span>
                    <br/>
                    <strong>{{ entry.literature.author }}</strong>
                </td>
                <td class="td-50 word-break">
                    <span class="delete-icon" ng-class="{'hidden-del': !hovered}" ng-click="mc.deleteSourceEntry($index, '#'+mc.modalFields.id)">
                        &times;
                    </span>
                    <span class="deletable" ng-bind-html="entry.description | urlify">
                    </span>
                </td>
            </tr>
        </table>
        <div class="col-md-5">
            <ui-select id="lit{{ attr.context_type_id }}_{{ attr.attr }}_{{ attr.option }}" ng-model="mc.modalFields.currentSource" close-on-select="true">
                <ui-select-match placeholder="{{'evidence.sources.literature'|translate}}">
                    {{ $select.selected.title | truncate:80:true }}
                </ui-select-match>
                <ui-select-choices repeat="lit in mc.modalFields.literature | filter:$select.search">
                    <div>
                        <div>
                            {{ lit.title | truncate:80:true }} <small><i style="color:gray; align: right;">{{ lit.author | truncate:80:true }}</i></small>
                        </div>
                        <small>{{ lit.year }}</small>
                    </div>
                </ui-select-choices>
            </ui-select>
        </div>
        <div class="col-md-5">
            <textarea class="form-control" ng-model="mc.modalFields.currentDesc" placeholder="{{'evidence.sources.comment'|translate}}"></textarea>
        </div>
        <div class="col-md-2">
            <button type="button" class="btn btn-success" style="width: 100%;" ng-click="mc.addSource(mc.modalFields.currentSource, mc.modalFields.currentDesc, mc.modalFields.id)" ng-disabled="!mc.modalFields.currentSource"><i class="material-icons" aria-hidden="true">add</i> {{ 'evidence.sources.add' | translate }}</button>
        </div>
    </div>
</div>
<div class="modal-footer">
    <!--<button type="button" class="btn btn-success" ng-click="saveSources()">{{ 'Save' | translate }}</button>-->
    <button type="button" class="btn btn-default"
      ng-click="mc.cancel()">{{ 'close' | translate }}</button>
</div>
